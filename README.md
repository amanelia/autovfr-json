AutoVFR -JSON中間ファイル出力プログラム-
---------------

About
----------
AviSynthのAuto_VFR関数で生成したログから直接avsファイルへ書き出さずにJSONファイルへ  
一旦書き出してほかのスクリプトでも使用できるようにします。  

ビルド環境
----------
* gcc (4.9.2)
* libjson (0.11) 必須  

特別な関数は使用していないのでMinGW-w64でもビルド出来ます。  
クロスコンパイルする場合はMakefile内のCC=gccを変更して下さい。

使いかた
----------
1. テロップやムービングロゴがない素材  
  `./autovfr -i "AutoVFRログファイル" -o "jsonファイル"`

2. テロップ・ムービングロゴがあるもの  
  `./autovfr -i "AutoVFRログファイル" -o "jsonファイル" --bob`

* --bob引数を指定せず、テロップもしくはムービングロゴが存在する場合は**次の周期番号**へ置き換えられます。  

### その他のオプション(試験的) ###
+ `--comb-num [数値]` 60iとなる縞数を指定します。  
  通常の3:2プルダウンの場合は  
  0010100101 (1は縞フレーム)などいくつかパターンが存在していますが動きが激しいシーンやムービングロゴの場合、  
  0110100111 のように縞フレームが連続してはいってしまいます。  
  この引数では60iかそうでないかを判断する上限の数値を指定します。  
  通常は3です。  

+ `--skip [数値]` 周期を決定する連続数を指定します。  
  通常は**3**ですが、ノイズや動きが少ない素材は**5**まで上げても大丈夫でしょう。  
  数値を上げるにつれて周期変更位置がズレる可能性があります。

+ `--verbose [数値]` 処理中のデバッグログを表示します。  
  1〜4の数値で上げるにつれて表示されるログも多くなります。  

今後オプションは増えていく予定です()  

出力JSONファイルについて
----------
出力される開始＆終了フレーム数は必ず5で割れるようになっています。  

## 出力ファイル例 ##

    {
        "cadence": [
            {
                "start": 0,
                "end": 1274,
                "type": "pref_0"
            },
            {
                "start": 1275,
                "end": 3239,
                "type": "bob",
                "txt60mc_type": 1
            },
            {
                "start": 3240,
                "end": 4439,
                "type": "pref_1"
            }
            ],
        "comb": [
            {
                "frame": 358,
                "type": "pref_0"
            },
            {
                "frame": 3347,
                "type": "pref_1"
            }
        ]
    }

## 各オブジェクトの説明 ##

### 周期リスト ###

* `cadance` :周期リストの配列です  
  + `type` :周期の種類です。pref(X)[Xは0から4の数値]か、bobが入ります。  
  + `start, end` :上記周期の開始フレームと終了フレームです。  
  + `txt60mc_type` :60iテロップなどを24pへ変えるスクリプト用の周期番号です。  
    (--bob引数ありで、テロップもしくはムービングロゴが存在する場合に書き込まれます。)  

### 解除縞リスト ###

* `comb` :解除縞リストの配列です  
  + `frame` :解除縞が存在するフレーム番号です。  
  + `type` :このフレーム番号が解除される周期です。pref(X)な値が入ります。  


仕様(これ重要)
----------
* オリジナルなAutoVFR.exeとの互換性は全くありません。  
  そのためオリジナルのAutoVFRと出力結果が異なります。  
* 動かないフレームは前の周期と同一視しているので分割される部分が  
  多少前後する可能性があります。  

アルゴリズム
----------
### 後に公開(すでにやる気なし) ###

更新履歴
----------
* *2015.08.29: 周期解析と解除縞解析のアルゴリズムを大幅変更*  

* *2015.08.11: 新規作成*  

URLなど
----------

[本家](http://putin999.blog.fc2.com/ "メモ置き場") 2015.08.11確認  

[やる気がなく、仕様が書けない自分のTwitter](https://twitter.com/amanelia)  

*2015.08.29 README更新*
